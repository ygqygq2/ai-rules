---
id: 1311
title: é¡¹ç›®å®‰å…¨å®¡è®¡æŠ€èƒ½
description: ä¾èµ–æ¼æ´æ£€æŸ¥ã€å®‰å…¨æ‰«æã€åˆè§„å®¡è®¡å·¥ä½œæµ
globs: ["**/package.json", "**/requirements.txt", "**/go.mod", "**/Cargo.toml"]
priority: high
tags: [security, audit, vulnerability, compliance, dependencies]
version: 1.0.0
author: Turbo AI Rules
lastUpdated: 2026-01-23
---

# é¡¹ç›®å®‰å…¨å®¡è®¡æŠ€èƒ½

## ä½•æ—¶ä½¿ç”¨

- ğŸ“¦ é¡¹ç›®ä¸Šçº¿å‰å®‰å…¨æ£€æŸ¥
- ğŸ”„ å®šæœŸä¾èµ–æ›´æ–°å®¡è®¡
- ğŸš¨ å‘ç° CVE æ¼æ´åæ’æŸ¥
- âœ… å®‰å…¨åˆè§„è¯„ä¼°
- ğŸ” ä»£ç åº“æ•æ„Ÿä¿¡æ¯æ‰«æ

## æ ¸å¿ƒå·¥ä½œæµ

### 1. ä¾èµ–æ¼æ´æ‰«æ

#### Node.js/npm

```bash
# å†…ç½®å®¡è®¡å·¥å…·
npm audit
npm audit --json > audit-report.json
npm audit fix  # è‡ªåŠ¨ä¿®å¤

# æ›´è¯¦ç»†çš„æŠ¥å‘Š
npx audit-ci --moderate  # CI ä¸­ä½¿ç”¨ï¼Œå‘ç°ä¸­å±åŠä»¥ä¸Šæ¼æ´ä¼šå¤±è´¥

# æ£€æŸ¥è¿‡æœŸä¾èµ–
npx npm-check-updates
npx depcheck  # æ£€æŸ¥æœªä½¿ç”¨çš„ä¾èµ–
```

#### Python

```bash
# ä½¿ç”¨ pip-auditï¼ˆæ¨èï¼‰
pip install pip-audit
pip-audit

# æˆ–ä½¿ç”¨ safety
pip install safety
safety check
safety check --json > safety-report.json

# æ£€æŸ¥ä¾èµ–æ ‘
pipdeptree --warn
```

#### Go

```bash
# æ¼æ´æ£€æŸ¥
go install golang.org/x/vuln/cmd/govulncheck@latest
govulncheck ./...

# ä¾èµ–å®¡è®¡
go list -m all
go mod graph | grep <package>
```

#### Rust

```bash
# cargo-audit
cargo install cargo-audit
cargo audit

# ç”ŸæˆæŠ¥å‘Š
cargo audit --json > audit-report.json
```

---

### 2. ä»£ç å®‰å…¨æ‰«æ

#### é€šç”¨å·¥å…·

```bash
# Trivyï¼ˆå¤šè¯­è¨€ã€å®¹å™¨é•œåƒæ‰«æï¼‰
trivy fs . --severity HIGH,CRITICAL
trivy image myapp:latest
trivy config .  # IaC æ‰«æ

# Snykï¼ˆéœ€æ³¨å†Œï¼‰
snyk test
snyk monitor  # æŒç»­ç›‘æ§
snyk code test  # é™æ€ä»£ç åˆ†æ
```

#### æ•æ„Ÿä¿¡æ¯æ£€æµ‹

```bash
# git-secrets
git secrets --scan
git secrets --scan-history

# TruffleHog
trufflehog git file://. --only-verified
trufflehog github --org=yourorg

# gitleaksï¼ˆæ¨èï¼‰
gitleaks detect --source . --verbose
gitleaks protect --staged  # pre-commit hook
```

#### é™æ€åˆ†æ

```bash
# Semgrepï¼ˆæ”¯æŒå¤šè¯­è¨€ï¼‰
semgrep --config=auto .
semgrep --config=p/security-audit .

# CodeQLï¼ˆGitHub æ¨èï¼‰
codeql database create mydb --language=javascript
codeql database analyze mydb --format=sarif-latest
```

---

### 3. å®¹å™¨é•œåƒæ‰«æ

```bash
# Docker Scout
docker scout cves myapp:latest
docker scout recommendations myapp:latest

# Grype
grype myapp:latest --scope all-layers

# æ£€æŸ¥åŸºç¡€é•œåƒ
docker history myapp:latest
dive myapp:latest  # åˆ†æé•œåƒå±‚
```

---

### 4. License åˆè§„æ£€æŸ¥

```bash
# Node.js
npx license-checker --summary
npx license-checker --json > licenses.json
npx legally  # ç”Ÿæˆæ³•å¾‹å£°æ˜

# Python
pip-licenses
pip-licenses --format=markdown > LICENSES.md

# Go
go-licenses csv ./...
go-licenses save ./... --save_path=./licenses
```

---

## å®Œæ•´å®¡è®¡æµç¨‹

### æ¯æ—¥/æ¯å‘¨æ£€æŸ¥

```bash
#!/bin/bash
# security-check.sh

echo "ğŸ” 1. ä¾èµ–æ¼æ´æ‰«æ..."
npm audit --audit-level=high || true

echo "ğŸ”’ 2. ä»£ç æ•æ„Ÿä¿¡æ¯æ£€æµ‹..."
gitleaks detect --no-git || true

echo "ğŸ“¦ 3. è¿‡æœŸä¾èµ–æ£€æŸ¥..."
npx npm-check-updates --target minor

echo "âœ… å®Œæˆï¼"
```

### ä¸Šçº¿å‰å®¡è®¡

```bash
# 1. å…¨é¢æ¼æ´æ‰«æ
trivy fs . --severity HIGH,CRITICAL --exit-code 1

# 2. ä»£ç è´¨é‡ä¸å®‰å…¨
semgrep --config=auto . --error

# 3. License åˆè§„
npx license-checker --failOn 'GPL;AGPL'

# 4. é•œåƒæ‰«æï¼ˆå¦‚æœ‰ï¼‰
docker scout cves myapp:latest --exit-code
```

### CI/CD é›†æˆ

```yaml
# .github/workflows/security.yml
name: Security Audit

on: [push, pull_request]

jobs:
  security:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Dependency Audit
        run: npm audit --audit-level=moderate

      - name: Secret Scan
        uses: trufflesecurity/trufflehog@main
        with:
          path: ./
          base: ${{ github.event.repository.default_branch }}

      - name: Trivy Scan
        uses: aquasecurity/trivy-action@master
        with:
          scan-type: "fs"
          severity: "CRITICAL,HIGH"
```

---

## æ¼æ´å¤„ç†å†³ç­–

### é£é™©è¯„çº§

| ç­‰çº§     | æè¿°       | å¤„ç†æ—¶é™ | è¡ŒåŠ¨                         |
| -------- | ---------- | -------- | ---------------------------- |
| CRITICAL | å¯ç›´æ¥åˆ©ç”¨ | 24h      | ç«‹å³ä¿®å¤æˆ–å›æ»š               |
| HIGH     | é—´æ¥å¯åˆ©ç”¨ | 7å¤©      | è®¡åˆ’ä¿®å¤ï¼Œä¸´æ—¶ç¼“è§£           |
| MEDIUM   | éœ€ç‰¹å®šæ¡ä»¶ | 30å¤©     | è¯„ä¼°å½±å“ï¼Œä¸‹ä¸ªè¿­ä»£ä¿®å¤       |
| LOW      | ç†è®ºé£é™©   | 90å¤©     | è®°å½•è¿½è¸ªï¼Œç‰ˆæœ¬æ›´æ–°æ—¶ä¸€å¹¶å¤„ç† |

### å†³ç­–æµç¨‹

```
å‘ç°æ¼æ´
  â†“
1. å½±å“è¯„ä¼°
   - é¡¹ç›®æ˜¯å¦ä½¿ç”¨å—å½±å“åŠŸèƒ½ï¼Ÿ
   - æ˜¯å¦æœ‰å…¬å¼€ Exploitï¼Ÿ
   - æ”»å‡»é¢æ˜¯å¦å¯è¾¾ï¼Ÿ
  â†“
2. ä¿®å¤é€‰é¡¹
   âœ… å‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬ï¼ˆä¼˜å…ˆï¼‰
   âœ… åº”ç”¨è¡¥ä¸
   âœ… æ›¿æ¢ä¾èµ–
   âš ï¸ ä¸´æ—¶ç¦ç”¨åŠŸèƒ½
   âš ï¸ WAF/é˜²ç«å¢™ç¼“è§£
  â†“
3. éªŒè¯æµ‹è¯•
   - å›å½’æµ‹è¯•é€šè¿‡
   - é‡æ–°æ‰«æç¡®è®¤ä¿®å¤
   - åŠŸèƒ½éªŒè¯æ­£å¸¸
  â†“
4. æ–‡æ¡£è®°å½•
   - æ›´æ–° CHANGELOG
   - è®°å½•ä¿®å¤æªæ–½
   - é€šçŸ¥ç›¸å…³å›¢é˜Ÿ
```

---

## å¸¸ç”¨æ£€æŸ¥æ¸…å•

### ä¸Šçº¿å‰å¿…æŸ¥

- [ ] `npm audit` / `pip-audit` æ—  HIGH/CRITICAL
- [ ] æ— ç¡¬ç¼–ç å¯†é’¥/Token
- [ ] License åˆè§„ï¼ˆæ—  GPL/AGPLï¼‰
- [ ] æ‰€æœ‰ä¾èµ–æ¥è‡ªå¯ä¿¡æº
- [ ] å®¹å™¨é•œåƒæ¼æ´æ‰«æé€šè¿‡
- [ ] ç¯å¢ƒå˜é‡é…ç½®æ£€æŸ¥
- [ ] æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨

### å®šæœŸå®¡è®¡ï¼ˆæ¯æœˆï¼‰

- [ ] æ›´æ–°æ‰€æœ‰ä¾èµ–åˆ°æœ€æ–°ç¨³å®šç‰ˆ
- [ ] è¿è¡Œå…¨é‡ Semgrep è§„åˆ™
- [ ] æ£€æŸ¥ git history ä¸­çš„æ³„éœ²
- [ ] å®¡æŸ¥ IAM æƒé™é…ç½®
- [ ] æ—¥å¿—å®¡è®¡ï¼ˆå¼‚å¸¸è®¿é—®ï¼‰
- [ ] ç¬¬ä¸‰æ–¹æœåŠ¡ API Key è½®æ¢

---

## å·¥å…·å¯¹æ¯”

| å·¥å…·      | è¯­è¨€æ”¯æŒ | æ¼æ´åº“          | å…è´¹ç‰ˆ | ç‰¹ç‚¹                |
| --------- | -------- | --------------- | ------ | ------------------- |
| npm audit | Node.js  | GitHub Advisory | âœ…     | å†…ç½®ï¼Œå¿«é€Ÿ          |
| Trivy     | å¤šè¯­è¨€   | NVD, Alpine     | âœ…     | å®¹å™¨+ä»£ç ï¼Œç¦»çº¿å¯ç”¨ |
| Snyk      | å¤šè¯­è¨€   | è‡ªæœ‰+NVD        | âš ï¸éƒ¨åˆ† | æ™ºèƒ½ä¿®å¤å»ºè®®        |
| Semgrep   | 30+è¯­è¨€  | è‡ªå®šä¹‰è§„åˆ™      | âœ…     | å¼ºå¤§çš„é™æ€åˆ†æ      |
| gitleaks  | ä»»æ„     | N/A             | âœ…     | æœ€ä½³æ•æ„Ÿä¿¡æ¯æ£€æµ‹    |
| CodeQL    | å¤šè¯­è¨€   | GitHub          | âœ…å¼€æº | GitHub æ·±åº¦é›†æˆ     |

---

## æœ€ä½³å®è·µ

âœ… **è‡ªåŠ¨åŒ–**:

- pre-commit hook é˜²æ­¢æ•æ„Ÿä¿¡æ¯æäº¤
- CI/CD å¿…é¡»åŒ…å«å®‰å…¨æ‰«æ
- ä¾èµ–æ›´æ–°è‡ªåŠ¨åŒ–ï¼ˆDependabot/Renovateï¼‰

âœ… **æŒç»­ç›‘æ§**:

- ä½¿ç”¨ Snyk/Dependabot ç›‘æ§æ–°æ¼æ´
- è®¢é˜…å®‰å…¨é‚®ä»¶åˆ—è¡¨
- å®šæœŸå®¡è®¡ç¬¬ä¸‰æ–¹æœåŠ¡

âœ… **çºµæ·±é˜²å¾¡**:

- æœ€å°æƒé™åŸåˆ™
- ç½‘ç»œéš”ç¦»
- è¾“å…¥éªŒè¯
- æ—¥å¿—ä¸ç›‘æ§

âŒ **é¿å…**:

- å¿½ç•¥ LOW/MEDIUM çº§åˆ«æ¼æ´
- ä½¿ç”¨è¿‡æ—¶çš„å·¥å…·ï¼ˆå¦‚åªç”¨ npm auditï¼‰
- è·³è¿‡å®¹å™¨é•œåƒæ‰«æ
- ä¸æµ‹è¯•ç›´æ¥åº”ç”¨å®‰å…¨è¡¥ä¸

---

## åº”æ€¥å“åº”

å½“å‘ç°ä¸¥é‡æ¼æ´æ—¶ï¼š

```bash
# 1. å¿«é€Ÿè¯„ä¼°
echo "æ¼æ´ID: CVE-2024-XXXX"
echo "å—å½±å“ç‰ˆæœ¬: package@1.0.0"
grep -r "package" package.json

# 2. ä¸´æ—¶ç¼“è§£
# - å›æ»šåˆ°å®‰å…¨ç‰ˆæœ¬
# - ç¦ç”¨å—å½±å“åŠŸèƒ½
# - éƒ¨ç½² WAF è§„åˆ™

# 3. æ­£å¼ä¿®å¤
npm install package@safe-version
npm audit  # éªŒè¯ä¿®å¤

# 4. éªŒè¯éƒ¨ç½²
curl https://api.example.com/health
grep "CVE-2024-XXXX" audit-report.json && echo "ä»å­˜åœ¨ï¼"
```

å®Œæˆåæ›´æ–°æ–‡æ¡£å¹¶é€šçŸ¥å›¢é˜Ÿã€‚
